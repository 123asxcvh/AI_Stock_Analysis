#!/usr/bin/env python

"""
市场数据分析提示词定义
使用Python多行字符串，支持语法高亮和易于维护
参考个股分析的结构，为市场数据创建精细化的提示词配置
"""

from datetime import datetime

def get_current_date() -> str:
    """获取当前日期字符串"""
    return datetime.now().strftime("%Y年%m月%d日")

def get_data_analysis_instruction() -> str:
    """获取数据分析指令"""
    current_date = get_current_date()
    return f"**重要说明：当前真实日期是{current_date}，请务必以此为准进行分析。严格基于提供的数据进行分析，不得质疑数据的准确性、完整性或来源可靠性。请按照最新的数据进行客观分析，不要进行主观推测。切记：现在是{current_date}，不是2022年或2024年！**"

# 概念板块资金流向分析 - 题材概念分析师
FUND_FLOW_CONCEPT = f"""# 任务：概念板块资金流向分析

**当前分析日期：{get_current_date()}**

{get_data_analysis_instruction()}

**时间提醒：请注意当前真实时间是{get_current_date()}，所有分析都应基于这个时间点进行，不要误认为是2022年或2024年！**

请基于提供的概念板块资金流向数据，进行市场热点概念分析。

## 分析要求
1. **数据解析与准备**: 准确识别并加载提供的`fund_flow_concept.csv`数据内容，确保能正确解析`净额`、`领涨股`等关键字段。

2. **资金净流入概念分析**:
   - 计算并列出**净流入资金 (`净额`) 排名前五**的概念板块及其具体净额。
   - 深入分析这些排名前五的概念，识别其共同特征、所属宏大叙事（例如：AI、新能源、国产替代、数字经济等），并简要阐述资金流入背后的市场逻辑或驱动因素。

3. **资金净流出概念分析**:
   - 计算并列出**净流出资金 (`净额`) 最多的前五**个概念板块及其具体净额。
   - 评估这些流出资金的概念是否为前期热门题材，并分析其资金流出的可能原因，判断市场是否有退潮或风格切换的迹象。

4. **领涨股信号评估**:
   - 针对步骤2中识别出的资金净流入靠前的概念，观察其`领涨股`（如果数据中包含此字段）的表现。
   - 判断是否存在涨停、大幅上涨或其他强势信号的龙头股在引领板块情绪，及其对整体板块的积极作用。

5. **市场热点与持续性判断**:
   - 综合上述所有分析，归纳出当前市场资金**最追捧的2-3个核心概念**。
   - 对这些核心概念的**短期热度**和**潜在的持续性**进行简要评估，并提供支持性论据。

## 输出格式
请严格按照以下Markdown格式输出分析报告：

```markdown
# 市场热点概念资金流向分析报告

## 1. 资金净流入最集中的概念
- [概念名称1]: 净额 [数值]
- [概念名称2]: 净额 [数值]
- ... (列出前五)
**共同特征分析**: [对共同特征和宏大叙事的总结]

## 2. 资金净流出最严重的概念
- [概念名称1]: 净额 [数值]
- [概念名称2]: 净额 [数值]
- ... (列出前五)
**退潮迹象评估**: [对前期热门题材是否退潮的分析]

## 3. 领涨股的信号意义
[对资金净流入概念中领涨股表现的观察与分析，指出是否存在龙头效应及具体案例]

## 4. 最终概念热点判断
- **核心概念1**: [概念名称]
  - 短期热度评估: [高/中/低]，理由: [简要说明]
  - 潜在持续性评估: [强/中/弱]，理由: [简要说明]
- **核心概念2**: [概念名称]
  - 短期热度评估: [高/中/低]，理由: [简要说明]
  - 潜在持续性评估: [强/中/弱]，理由: [简要说明]
```

## 约束条件
- 所有分析结论必须严格基于提供的`fund_flow_concept.csv`数据
- 报告内容必须严格遵循上述输出结构，不得自行更改或添加其他章节
- 避免使用主观臆断，所有判断需有数据或逻辑支持
- 分析内容必须明确标注分析日期为`{get_current_date()}`，避免任何时间上的混淆或错误
- 最终输出应仅包含分析报告本身，不得包含任何步骤说明或其他无关内容

---
**数据输入：**
[此处粘贴 `fund_flow_concept.csv` 的数据内容]"""

# 行业资金流向分析 - 行业轮动策略师
FUND_FLOW_INDUSTRY = f"""# 任务：行业资金流向分析

**当前分析日期：{get_current_date()}**

{get_data_analysis_instruction()}

**时间提醒：请注意当前真实时间是{get_current_date()}，所有分析都应基于这个时间点进行，不要误认为是2022年或2024年！**

请基于提供的行业资金流向数据，进行行业配置策略分析。

## 分析要求
1. **数据解读与市场定性**: 接收并深入分析提供的行业资金流向数据，初步判断市场整体活跃度与结构性特征。

2. **行业轮动阶段识别**: 基于资金流向数据，结合历史经验，准确判断当前市场所处的行业轮动阶段（如复苏、繁荣、衰退、滞涨等）。

3. **市场风格偏好分析**: 结合资金流向及行业表现，识别当前市场是偏好成长股还是价值股、大盘股还是小盘股、周期股还是防御股。

4. **行业配置策略制定**: 依据轮动阶段和风格偏好，制定具体的行业配置建议，包括超配（Overweight）、低配（Underweight）和规避（Avoid）的行业列表，并给出大致的配置比例区间。

5. **时机与持续性评估**: 评估当前行业轮动的潜在启动时机和可持续性，判断其未来发展趋势。

6. **风险预警与关注点提示**: 识别行业轮动过程中可能存在的风险点、潜在的转折信号及宏观经济变化可能带来的影响。

7. **形成综合分析报告**: 将以上分析结果整合，撰写一份结构清晰、结论明确的行业配置策略分析报告。

## 输出格式
请严格按照以下Markdown格式输出分析报告：

```markdown
# 行业配置策略分析报告

## 1. 市场资金流向概述
[分析内容]

## 2. 当前行业轮动阶段判断
[判断结果及依据]

## 3. 市场风格偏好分析
[风格判断及理由]

## 4. 行业配置策略建议
### 4.1 超配行业
- [行业名称]: [配置比例建议] - [核心理由]
### 4.2 低配行业
- [行业名称]: [配置比例建议] - [核心理由]
### 4.3 规避行业
- [行业名称]: [规避理由]

## 5. 轮动时机与持续性评估
[分析内容]

## 6. 风险预警与关注点
[风险提示]
```

## 约束条件
- 分析必须严格基于提供的行业资金流向数据，避免主观臆断
- 提供的行业配置建议需具体到超配/低配/规避的行业名称，并包含推荐理由
- 报告内容需涵盖市场轮动阶段、风格判断、配置建议、时机把握和风险预警等所有核心要素
- 分析内容必须明确标注分析日期为`{get_current_date()}`，避免任何时间上的混淆或错误
- 最终输出应仅包含分析报告本身，不得包含任何步骤说明或其他无关内容

---
**数据输入：**
[此处粘贴 `fund_flow_industry.csv` 的数据内容]"""

# 板块资金流分析 - 主力资金动向深度分析
SECTOR_FUND_FLOW = f"""# 任务：板块资金流向分析

**当前分析日期：{get_current_date()}**

{get_data_analysis_instruction()}

**时间提醒：请注意当前真实时间是{get_current_date()}，所有分析都应基于这个时间点进行，不要误认为是2022年或2024年！**

请基于提供的板块资金流向数据，进行主力资金动向深度分析。

## 分析要求
1. **数据解析与准备**: 仔细阅读并理解`sector_fund_flow.csv`中的所有列名及数据含义，特别是"今日主力净流入-净额"、"今日超大单净流入-净额"和"今日小单净流入-净额"。

2. **资金流入焦点分析 (Top Inflows)**:
   - 筛选出"今日主力净流入-净额"排名前三的板块。
   - 检查这些板块是否同时获得"今日超大单净流入-净额"的显著支持。
   - 基于数据，解读这通常意味着大资金在这些板块上形成了何种共识。

3. **资金流出重灾区分析 (Top Outflows)**:
   - 筛选出"今日主力净流入-净额"流出最多（负值最大）的前三个板块。
   - 结合市场常见逻辑，分析主力资金从这些板块撤离的可能原因。

4. **机构与散户行为博弈分析**:
   - **寻找分歧点**: 识别"今日主力净流入-净额"为负，但同时"今日小单净流入-净额"为正的板块。解读这种分歧现象，说明主力资金出货与散户资金接盘的可能性。
   - **寻找共识点**: 识别"今日主力净流入-净额"和"今日小单净流入-净额"方向一致的板块。分析这种一致性反映了市场在该板块上形成了怎样的合力。

5. **资金流向强度评估**:
   - 分析各板块的资金流向强度，通过净额绝对值大小判断资金进出的激烈程度。
   - 识别是否存在异常大额资金流动，这可能预示着重要的市场变化。

6. **市场情绪与趋势判断**:
   - 综合所有分析结果，判断当前市场的整体情绪倾向。
   - 识别可能的市场风格切换信号和潜在的投资机会。

## 输出格式
请严格按照以下Markdown格式输出分析报告：

```markdown
# 主力资金动向深度分析报告

## 1. 资金流入焦点分析
### 1.1 主力资金最青睐的板块
- [板块名称1]: 主力净流入 [数值] 亿元，超大单净流入 [数值] 亿元
- [板块名称2]: 主力净流入 [数值] 亿元，超大单净流入 [数值] 亿元
- [板块名称3]: 主力净流入 [数值] 亿元，超大单净流入 [数值] 亿元
**大资金共识解读**: [分析大资金在这些板块形成共识的原因和意义]

## 2. 资金流出重灾区分析
### 2.1 主力资金撤离最严重的板块
- [板块名称1]: 主力净流出 [数值] 亿元
- [板块名称2]: 主力净流出 [数值] 亿元
- [板块名称3]: 主力净流出 [数值] 亿元
**撤离原因分析**: [分析主力资金撤离这些板块的可能原因]

## 3. 机构与散户博弈分析
### 3.1 分歧板块（主力出货，散户接盘）
- [板块名称]: 主力净流出 [数值] 亿元，小单净流入 [数值] 亿元
**博弈解读**: [分析这种分歧现象的市场含义]

### 3.2 共识板块（主力散户同向）
- [板块名称]: 主力净流入 [数值] 亿元，小单净流入 [数值] 亿元
**合力解读**: [分析市场合力形成的意义]

## 4. 资金流向强度评估
### 4.1 异常大额资金流动
[识别并分析异常大额资金流动的板块及其可能影响]

### 4.2 资金流向强度排名
[按资金流向强度对板块进行排序分析]

## 5. 市场情绪与趋势判断
### 5.1 整体市场情绪评估
[基于资金流向数据判断当前市场整体情绪]

### 5.2 潜在投资机会识别
- **重点关注板块**: [基于资金流向识别的投资机会]
- **风险警示板块**: [需要规避的风险板块]
- **风格切换信号**: [可能的市场风格变化信号]

## 6. 投资策略建议
### 6.1 短期策略
[基于资金流向的短期投资策略建议]

### 6.2 风险提示
[基于资金流向分析的风险提示]
```

## 约束条件
- 所有分析结论必须严格基于提供的`sector_fund_flow.csv`数据
- 报告内容必须严格遵循上述输出结构，不得自行更改或添加其他章节
- 避免使用主观臆断，所有判断需有数据或逻辑支持
- 数值分析要精确到具体数字，避免模糊表述
- 分析内容必须明确标注分析日期为`{get_current_date()}`，避免任何时间上的混淆或错误
- 最终输出应仅包含分析报告本身，不得包含任何步骤说明或其他无关内容

---
**数据输入：**
[此处粘贴 `sector_fund_flow.csv` 的数据内容]"""

# 个股资金流向分析 - 个股资金流分析师
FUND_FLOW_INDIVIDUAL = f"""# 任务：个股资金流向分析

**当前分析日期：{get_current_date()}**

{get_data_analysis_instruction()}

**时间提醒：请注意当前真实时间是{get_current_date()}，所有分析都应基于这个时间点进行，不要误认为是2022年或2024年！**

请基于提供的个股资金流向数据，进行个股资金流向深度分析。

## 分析要求
1. **数据解析与准备**: 准确识别并加载提供的`fund_flow_individual.csv`数据内容，确保能正确解析`净额`、`涨跌幅`、`换手率`、`净流入比例`等关键字段。

2. **资金净流入个股分析**:
   - 计算并列出**净流入资金 (`净额`) 排名前10**的个股及其具体净额。
   - 分析这些净流入个股的**共同特征**（如行业、市值、涨跌幅等），识别资金青睐的个股类型。
   - 评估这些个股的**投资价值和风险**，判断是否为优质投资标的。

3. **资金净流出个股分析**:
   - 计算并列出**净流出资金 (`净额`) 最多的前10**个个股及其具体净额。
   - 分析这些净流出个股的**共同特征**，识别资金撤离的个股类型。
   - 评估这些个股的**风险程度**，判断是否应该规避。

4. **市场活跃度分析**:
   - 分析**换手率**排名前10的个股，识别市场最活跃的个股。
   - 结合**涨跌幅**和**净流入比例**，判断市场情绪和资金偏好。
   - 识别是否存在**异常交易**或**资金异动**的个股。

5. **投资机会识别**:
   - 综合资金流向、涨跌幅、换手率等指标，识别**潜在投资机会**。
   - 分析**资金流向与股价表现**的关联性，判断资金流向的预测价值。
   - 提供**具体的投资建议**和**风险提示**。

## 输出格式
请严格按照以下Markdown格式输出分析报告：

```markdown
# 个股资金流向分析报告

## 1. 资金净流入最集中的个股
- [股票名称1]: 净额 [数值] 亿元，涨跌幅 [数值]%，换手率 [数值]%
- [股票名称2]: 净额 [数值] 亿元，涨跌幅 [数值]%，换手率 [数值]%
- ... (列出前10)
**共同特征分析**: [对净流入个股共同特征的分析]

## 2. 资金净流出最严重的个股
- [股票名称1]: 净额 [数值] 亿元，涨跌幅 [数值]%，换手率 [数值]%
- [股票名称2]: 净额 [数值] 亿元，涨跌幅 [数值]%，换手率 [数值]%
- ... (列出前10)
**风险特征分析**: [对净流出个股风险特征的分析]

## 3. 市场活跃度分析
### 3.1 换手率最高的个股
- [股票名称]: 换手率 [数值]%，净流入比例 [数值]%
**活跃度解读**: [对市场活跃度的分析]

### 3.2 异常交易识别
[识别并分析异常交易或资金异动的个股]

## 4. 投资机会与风险提示
### 4.1 潜在投资机会
- **重点关注个股**: [基于资金流向识别的投资机会]
- **投资逻辑**: [具体的投资理由和逻辑]

### 4.2 风险提示
- **需要规避的个股**: [基于资金流向识别的风险个股]
- **风险原因**: [具体的风险原因和规避理由]

## 5. 资金流向预测价值
### 5.1 资金流向与股价关联性
[分析资金流向与股价表现的关联性]

### 5.2 预测价值评估
[评估资金流向数据的预测价值和局限性]

## 6. 投资策略建议
### 6.1 短期策略
[基于个股资金流向的短期投资策略建议]

### 6.2 风险控制
[基于个股资金流向的风险控制建议]
```

## 约束条件
- 所有分析结论必须严格基于提供的`fund_flow_individual.csv`数据
- 报告内容必须严格遵循上述输出结构，不得自行更改或添加其他章节
- 避免使用主观臆断，所有判断需有数据或逻辑支持
- 数值分析要精确到具体数字，避免模糊表述
- 分析内容必须明确标注分析日期为`{get_current_date()}`，避免任何时间上的混淆或错误
- 最终输出应仅包含分析报告本身，不得包含任何步骤说明或其他无关内容

---
**数据输入：**
[此处粘贴 `fund_flow_individual.csv` 的数据内容]"""

# 涨停股池分析 - 市场情绪先锋
ZT_POOL = f"""# 任务：涨停股池分析

**当前分析日期：{get_current_date()}**

{get_data_analysis_instruction()}

**时间提醒：请注意当前真实时间是{get_current_date()}，所有分析都应基于这个时间点进行，不要误认为是2022年或2024年！**

请基于提供的涨停股池数据，进行市场最强风口分析。

## 分析要求
1. **数据接收与市场情绪概览**:
   - 接收并处理用户提供的 `zt_pool.csv` 数据。
   - 统计今日涨停股票的总数，并基于数量评估市场情绪强弱（例如，明确指出今日总数对应的情绪等级：<50只为一般，50-100只为较好，>100只为火爆）。
   - 识别并记录市场中最高的连板数，以此判断短线炒作的"天花板"。

2. **主流热点题材识别**:
   - 将所有涨停股按其`所属行业`进行详细归类统计。
   - 根据各行业涨停股的数量，识别并明确指出一个或多个涨停数量最多的行业，作为当前市场的"绝对主流"题材。

3. **龙头与梯队结构分析**:
   - 确定全市场连板数最高的股票为"空间龙头"，并指出其所属行业。
   - 在识别出的主流热点行业中，分析是否存在清晰的"龙头-跟风"梯队结构（例如，该行业内是否有高连板股及一批首次涨停的"首板"股）。
   - 分析涨停股的`炸板次数`，评估涨停的质量和封板意愿的坚决程度（如：炸板次数多的股票可能意味着多空分歧较大，封板意愿不坚决）。

4. **最终市场风口判断**:
   - 综合上述分析，明确指出当前市场"最强的主线题材"是什么。
   - 识别并列出该题材的"龙头股"和"核心跟风股"。
   - 基于数据分析，简要评估该题材的"持续性潜力"。

## 输出格式
请严格按照以下Markdown格式输出分析报告：

```markdown
# 市场涨停股风口分析报告

## 1. 市场情绪概览
- **涨停总数**: [具体数量] 只
- **情绪等级**: [一般/较好/火爆]
- **最高连板数**: [具体数字] 板
- **短线炒作天花板**: [分析]

## 2. 主流热点题材识别
- **绝对主流题材**: [行业名称]
- **涨停数量**: [具体数量] 只
- **市场占比**: [百分比]

## 3. 龙头与梯队结构分析
### 3.1 空间龙头
- **龙头股**: [股票名称]
- **连板数**: [具体数字] 板
- **所属行业**: [行业名称]

### 3.2 梯队结构
- **龙头股**: [股票名称] - [连板数] 板
- **跟风股**: [列出核心跟风股]
- **首板股**: [列出首板股数量]

### 3.3 涨停质量分析
- **炸板次数分析**: [分析炸板次数多的股票及其含义]

## 4. 最终市场风口判断
- **最强主线题材**: [题材名称]
- **龙头股**: [股票名称]
- **核心跟风股**: [列出核心跟风股]
- **持续性潜力**: [强/中/弱] - [理由]
```

## 约束条件
- 报告内容必须完全基于提供的 `zt_pool.csv` 数据进行分析，不得引入外部数据或主观臆测
- 市场情绪强弱的判断需明确指出对应的涨停总数
- 炸板次数的分析需结合具体股票案例说明其含义
- 分析内容必须明确标注分析日期为`{get_current_date()}`，避免任何时间上的混淆或错误
- 最终输出应仅包含分析报告本身，不得包含任何步骤说明或其他无关内容

---
**数据输入：**
[此处粘贴 `zt_pool.csv` 的数据内容]"""

# 龙虎榜详情分析 - 龙虎榜资金行为研究专家
LHB_DETAIL = f"""# 任务：龙虎榜资金博弈分析

**当前分析日期：{get_current_date()}**

{get_data_analysis_instruction()}

**时间提醒：请注意当前真实时间是{get_current_date()}，所有分析都应基于这个时间点进行，不要误认为是2022年或2024年！**

请基于提供的龙虎榜数据，进行资金博弈深度分析。

## 分析要求
1. **数据解析与概览**: 接收 `lhb_detail.csv` 数据，进行初步解析，了解数据量、涉及的股票和交易日期范围。

2. **机构席位行为分析**: 筛选出"机构专用"席位的交易记录，计算每只股票的机构净买入/卖出金额，并尝试识别相关行业/概念。判断其对特定赛道的看好程度。

3. **知名游资席位识别与分析**: 基于席位名称或交易特征（如大额买卖、频繁上榜等），识别知名游资席位，分析他们主导买卖的股票及背后的可能炒作题材/逻辑。

4. **买卖力量综合评估**: 结合机构和游资的动向，计算每只上榜股票的买卖集中度（例如买一席位远超卖一）和总净买卖额，判断买卖双方力量对比。

5. **博弈模式总结**: 基于上述分析，识别和归纳出市场中存在的典型资金博弈模式，如"机构与游资合力做多"、"机构出货游资接盘"或"游资对倒"等。

6. **启示与风险提炼**: 总结整体市场资金流向的核心攻击方向、顶级玩家（机构与游资）的分歧点，并结合数据（如`上榜后1日`数据，如数据包含）或市场常识，预估并提示跟随上榜股票的潜在风险（如"一日游"行情、高位接盘风险）。

## 输出格式
请严格按照以下Markdown格式输出分析报告：

```markdown
# 龙虎榜资金博弈深度分析报告

## 1. 机构席位动向 (Institutional Desk Activity)
- **净买入股票分析**:
    - 列表呈现出现机构专用席位净买入的股票、其所属行业或概念，并判断机构对这些赛道的看好程度。
- **净卖出股票分析**:
    - 列表呈现被机构席位净卖出的股票，分析其行为是获利了结还是调仓换股。

## 2. 知名游资动向 (Top Speculator Activity)
- **主导买卖股票分析**:
    - 识别并列出知名游资席位及其主导买入或卖出的股票。
- **炒作题材与逻辑**:
    - 深入分析这些游资主导股票背后的炒作题材、催化剂或交易逻辑。

## 3. 买卖双方力量对比
- **整体力量评估**:
    - 综合分析龙虎榜上的股票，哪些是买方力量更集中（如买一席位远超卖一，龙虎榜净买额为正且巨大），哪些是卖方抛压更重。
- **典型博弈模式**:
    - 识别并描述是否存在"机构与游资合力"买入，或者"机构卖出、游资接盘"等典型的博弈模式案例。

## 4. 最终龙虎榜启示
- **市场核心攻击方向与分歧点**:
    - 总结当日龙虎榜所揭示的市场核心攻击方向和顶级玩家（机构与游资）的主要分歧点。
- **潜在风险提示**:
    - 提示跟随这些上榜股票的潜在风险，例如"一日游"行情的可能性，或其他基于数据或经验的风险考量。
```

## 约束条件
- 所有分析结论必须完全基于提供的 `lhb_detail.csv` 数据，不得凭空臆断
- 报告中不得直接复述或罗列原始数据，仅呈现分析结果和洞察
- 在识别"知名游资"时，如果数据中没有明确标识，请基于其交易金额和活跃度进行合理推断或注明判断依据
- 分析内容必须明确标注分析日期为`{get_current_date()}`，避免任何时间上的混淆或错误
- 最终输出应仅包含分析报告本身，不得包含任何步骤说明或其他无关内容

---
**数据输入：**
[此处粘贴 `lhb_detail.csv` 的数据内容]"""

# 实时行情分析 - 市场健康度诊断报告撰写与市场脉搏分析
REALTIME_QUOTES = f"""# 任务：实时市场行情分析

**当前分析日期：{get_current_date()}**

{get_data_analysis_instruction()}

**时间提醒：请注意当前真实时间是{get_current_date()}，所有分析都应基于这个时间点进行，不要误认为是2022年或2024年！**

请基于提供的实时市场行情数据，进行市场健康度诊断分析。

## 分析要求
1. **数据接收与初步处理**: 接收并解析 `realtime_quotes.csv` 中的市场行情数据。

2. **市场整体氛围分析 (Overall Market Breadth)**:
   - 统计并对比上涨、下跌和持平的股票家数。
   - 判断市场是普涨、普跌还是结构性行情，并量化上涨与下跌家数的比例悬殊程度。

3. **市场情绪强度分析 (Sentiment Intensity)**:
   - 统计并分析涨停和跌停的股票家数，评估市场投机情绪或恐慌情绪的强度。
   - 分析"昨日涨停表现"数据，判断市场情绪的持续性和连板效应。

4. **核心板块表现分析 (Leading & Lagging Sectors)**:
   - 根据行业涨跌幅，识别并列出涨幅前三的"领涨行业"和跌幅前三的"领跌行业"。
   - 简要描述当前市场的主线热点和被抛售的板块。

5. **综合诊断与结论**:
   - 综合上述所有分析结果，对当前市场的健康度、情绪和结构进行总结。
   - 用一句话给出明确的市场"温度"诊断（例如：市场情绪高涨，呈普涨格局；市场分化严重，资金抱团核心板块；市场情绪低迷，避险情绪升温等）。

## 输出格式
请严格按照以下Markdown格式输出分析报告：

```markdown
# 市场健康度诊断报告

## 1. 市场整体氛围分析
- **上涨股票**: [数量] 只
- **下跌股票**: [数量] 只
- **持平股票**: [数量] 只
- **市场格局**: [普涨/普跌/结构性行情]
- **涨跌比例**: [具体比例]

## 2. 市场情绪强度分析
- **涨停股票**: [数量] 只
- **跌停股票**: [数量] 只
- **情绪强度**: [高涨/温和/低迷]
- **昨日涨停表现**: [分析连板效应]

## 3. 核心板块表现分析
### 3.1 领涨行业
- [行业1]: [涨跌幅]%
- [行业2]: [涨跌幅]%
- [行业3]: [涨跌幅]%

### 3.2 领跌行业
- [行业1]: [涨跌幅]%
- [行业2]: [涨跌幅]%
- [行业3]: [涨跌幅]%

## 4. 综合诊断与结论
- **市场健康度**: [健康/一般/不健康]
- **市场温度**: [一句话概括市场状态]
- **投资建议**: [基于诊断的投资建议]
```

## 约束条件
- 报告必须严格遵循上述分析框架
- 分析结论必须基于提供的数据，不得凭空臆测
- 最终市场诊断必须用一句话概括，并具有指导性
- 报告中不得包含任何除报告本身以外的说明性文字
- 分析内容必须明确标注分析日期为`{get_current_date()}`，避免任何时间上的混淆或错误
- 最终输出应仅包含分析报告本身，不得包含任何步骤说明或其他无关内容

---
**数据输入：**
[此处粘贴 `realtime_quotes.csv` 的数据内容]"""

# 市场综合策略分析 - 撰写市场综合投资策略报告
MARKET_ALL_ANALYSIS = f"""# 任务：市场综合分析策略报告

**当前分析日期：{get_current_date()}**

{get_data_analysis_instruction()}

**时间提醒：请注意当前真实时间是{get_current_date()}，所有分析都应基于这个时间点进行，不要误认为是2022年或2024年！**

请基于提供的市场分析报告，撰写今日的市场综合投资策略报告。

## 分析要求
1. **报告消化与信息提取**: 仔细阅读并全面理解提供的所有市场分析报告内容，识别并提取其中关于市场温度、健康度、核心主题、资金流向、市场情绪（涨停、龙虎榜）等关键数据点和分析结论。

2. **市场状态总结撰写**:
   - 综合所有市场分析报告的结论，用一句话概括当前市场的**整体温度**（例如：火热、温和、冰冷）和**健康度**（例如：普涨、普跌、结构性分化）。
   - 综合所有报告，识别并明确当前市场的**核心驱动力或主线题材**。

3. **多维信息交叉验证与核心判断**:
   - **资金流向验证**: 分析资金流向系列报告（概念资金流、行业资金流、板块资金流、个股资金流），识别"聪明钱"正在**流入/流出**的行业与概念，并与市场表现进行比对，确认一致性或差异。
   - **市场情绪验证**: 分析涨停股池报告，验证涨停股池揭示的**最强题材**和**市场热点**。识别并解读可能存在的**信号分歧**（如涨停多但资金流出）。
   - **核心判断**: 基于以上交叉验证结果，对市场的**短期（1-3天）走势**做出明确的核心判断（例如：上涨趋势健康且有望延续、短期情绪过热面临回调风险、板块轮动加快，操作难度加大等）。

4. **今日投资策略制定**:
   - **总体仓位建议**: 根据核心判断，给出**激进、中性，还是防御**的总体仓位水平建议。
   - **重点关注方向（做多策略）**: 明确应重点布局的**主线板块/概念**，并给出在这些板块中采取**追逐最强龙头**还是**低吸板块内补涨**的策略建议。
   - **需要规避的方向（风险管理）**: 指出哪些板块因资金持续抛弃或主力出货迹象应**规避或减仓**，并阐述当前策略面临的主要风险以及调整策略的依据信号。

5. **未来一周热门领域预判**:
   - **趋势延续性分析**: 基于当前资金流向、市场情绪和板块轮动特征，判断现有主线题材在未来一周的**延续性**和**强度变化**。
   - **新兴热点识别**: 从资金流向数据中识别可能正在**萌芽**或**蓄势**的新兴概念和行业，评估其成为下一周热点的**概率**和**催化剂**。
   - **轮动节奏预判**: 结合历史轮动规律和当前市场结构，预判未来一周可能的**板块轮动方向**和**时间节点**。
   - **风险点预警**: 识别可能在未来一周对市场产生**负面冲击**的因素或板块，提前预警风险。

6. **总结与展望撰写**: 用简洁的语言，再次总结今天的**核心观点**和**操作要点**。

7. **结构化报告输出**: 将以上所有分析和策略严格按照"输出要求"中定义的框架进行组织和呈现。

## 输出格式
请严格按照以下五大部分的结构输出分析报告：

```markdown
**第一部分：市场状态总结 (Executive Summary)**
1.  **市场温度与健康度：** [一句话概括]
2.  **市场核心主题：** [核心驱动力或主线题材]

**第二部分：多维信息交叉验证与核心判断 (Cross-Validation & Core Thesis)**
1.  **资金流向验证：**
    *   流入行业与概念：[列表或描述]
    *   流出领域：[列表或描述]
    *   与实时行情相符性：[分析]
2.  **市场情绪验证：**
    *   最强题材与资金认可：[分析]
    *   信号分歧与解读：[分析]
3.  **核心判断：** [短期走势判断]

**第三部分：今日投资策略 (Actionable Strategy)**
1.  **总体仓位建议：** [激进、中性、防御]
2.  **重点关注方向（做多策略）：**
    *   主线板块/概念：[列表或描述]
    *   操作策略：[追逐龙头或低吸补涨]
3.  **需要规避的方向（风险管理）：**
    *   规避/减仓板块：[列表或描述]
    *   主要风险与策略调整依据：[分析]

**第四部分：未来一周热门领域预判**
1.  **趋势延续性分析：**
    *   现有主线延续性：[判断现有主线题材在未来一周的延续性和强度变化]
    *   强度变化预期：[分析主线题材强度可能的变化趋势]
2.  **新兴热点识别：**
    *   萌芽概念：[识别可能正在萌芽的新兴概念和行业]
    *   催化剂分析：[评估成为下一周热点的概率和催化剂]
3.  **轮动节奏预判：**
    *   轮动方向：[预判未来一周可能的板块轮动方向]
    *   时间节点：[预测轮动可能发生的时间节点]
4.  **风险点预警：**
    *   负面冲击因素：[识别可能产生负面冲击的因素或板块]
    *   预警信号：[提前预警风险的具体信号]

**第五部分：总结与展望**
-   [核心观点和操作要点总结]
```

## 约束条件
- 报告必须严格遵循上述五部分分析框架，不得增减任何一级或二级标题
- 所有结论和策略建议都必须直接来源于所提供的市场分析报告内容，不得凭空臆断或添加个人主观意见
- 语言精炼，避免冗余和口语化表达
- 分析内容必须明确标注分析日期为`{get_current_date()}`，避免任何时间上的混淆或错误
- 最终输出应仅包含策略报告本身，不得包含任何步骤说明或其他无关内容

---
**数据输入：**
[此处粘贴所有市场分析报告的内容，包括：
- fund_flow_concept.md (概念资金流分析)
- fund_flow_industry.md (行业资金流分析)
- fund_flow_individual.md (个股资金流分析)
- zt_pool.md (涨停股池分析)
- news_main_cx.md (财经新闻舆情分析)
- market_activity_legu.md (市场赚钱效应分析)
等报告内容]"""

# 财经新闻舆情分析 - 新闻舆情分析师
NEWS_MAIN_CX = f"""# 任务：财经新闻舆情分析

**当前分析日期：{get_current_date()}**

{get_data_analysis_instruction()}

**时间提醒：请注意当前真实时间是{get_current_date()}，所有分析都应基于这个时间点进行，不要误认为是2022年或2024年！**

请基于提供的最新财经新闻数据，进行专业的舆情分析和市场预判。

## 分析要求
1. **新闻分类统计**:
   - 按标签对新闻进行分类统计，识别主要新闻类型（如：政策、公司、行业、宏观、国际等）
   - 计算各类别新闻的数量占比，分析当前市场的关注焦点

2. **情绪倾向分析**:
   - 基于新闻标题和摘要内容，评估整体市场情绪（积极/中性/消极）
   - 识别正面和负面新闻，分析其对市场情绪的潜在影响

3. **热点事件识别**:
   - 提取最重要的3-5个热点事件或政策动向
   - 分析这些事件可能对相关板块和个股产生的影响

4. **行业影响评估**:
   - 识别新闻中涉及的主要行业和概念板块
   - 评估哪些行业可能受益，哪些可能承压

5. **投资机会与风险**:
   - 基于新闻分析，识别潜在的投资机会和需要规避的风险
   - 提供具体的关注方向和建议

## 输出格式
```
# 财经新闻舆情分析报告
**分析日期：{get_current_date()}**

## 一、新闻概况统计
- **总新闻数量**: [数量]
- **主要新闻类型**: [按数量排序的类别及占比]
- **时间分布**: [新闻时间分布特征]

## 二、市场情绪分析
- **整体情绪倾向**: [积极/中性/消极]
- **正面新闻占比**: [百分比]
- **负面新闻占比**: [百分比]
- **情绪强度评估**: [强/中/弱]

## 三、热点事件聚焦
1. **[热点事件1]**
   - 事件概述：[简要描述]
   - 影响分析：[对市场的潜在影响]
   - 关注板块：[相关板块]

2. **[热点事件2]**
   - 事件概述：[简要描述]
   - 影响分析：[对市场的潜在影响]
   - 关注板块：[相关板块]

3. **[热点事件3]**
   - 事件概述：[简要描述]
   - 影响分析：[对市场的潜在影响]
   - 关注板块：[相关板块]

## 四、行业影响评估
### 受益行业
- **[行业1]**: [受益原因和预期影响]
- **[行业2]**: [受益原因和预期影响]

### 承压行业
- **[行业1]**: [承压原因和预期影响]
- **[行业2]**: [承压原因和预期影响]

## 五、投资策略建议
### 重点关注
- **[方向1]**: [关注理由和操作建议]
- **[方向2]**: [关注理由和操作建议]

### 风险规避
- **[风险1]**: [风险描述和规避策略]
- **[风险2]**: [风险描述和规避策略]

## 六、舆情趋势展望
- **短期预期**: [1-3天市场舆情走向]
- **中期趋势**: [1周内舆情发展预期]
```

## 约束条件
- 分析必须基于提供的新闻数据，不得添加外部信息
- 情绪判断要客观理性，避免过度解读
- 投资建议要谨慎，明确提示风险
- 所有时间引用必须准确，确保使用{get_current_date()}作为分析基准

---
**数据输入：**

[此处粘贴news_main_cx.csv的新闻数据内容]"""

# 市场赚钱效应分析 - 市场赚钱效应分析师
MARKET_ACTIVITY_LEGU = f"""# 任务：市场赚钱效应分析

**当前分析日期：{get_current_date()}**

{get_data_analysis_instruction()}

**时间提醒：请注意当前真实时间是{get_current_date()}，所有分析都应基于这个时间点进行，不要误认为是2022年或2024年！**

请基于提供的市场活跃度数据，进行专业的赚钱效应分析和投资建议。

## 分析要求
1. **市场基础数据分析**:
   - 计算上涨/下跌股票比例，分析市场整体强弱
   - 分析涨停/跌停股票数量，评估市场极端情绪
   - 计算真实涨停跌停数据，排除ST股影响

2. **赚钱效应强度评估**:
   - 基于上涨下跌比例计算赚钱效应指标
   - 分析涨停股票数量与市场活跃度的关系
   - 评估当前市场的赚钱效应强度（强/中/弱）

3. **市场结构分析**:
   - 分析ST股票的表现，识别风险偏好变化
   - 评估平盘和停牌股票比例，分析市场观望情绪
   - 综合判断市场参与度和活跃度

4. **风险收益评估**:
   - 基于当前数据评估短期投资风险
   - 分析当前市场环境下的机会把握难度
   - 提供适合当前市场的操作策略

## 输出格式
```
# 市场赚钱效应分析报告
**分析日期：{get_current_date()}**

## 一、市场基础数据
- **上涨股票数**: [数量] ([占比])
- **下跌股票数**: [数量] ([占比])
- **涨停股票数**: [数量]
- **跌停股票数**: [数量]
- **真实涨停**: [数量] (排除ST)
- **真实跌停**: [数量] (排除ST)
- **平盘股票数**: [数量]
- **停牌股票数**: [数量]
- **市场活跃度**: [数值/描述]

## 二、赚钱效应强度分析
### 整体赚钱效应
- **赚钱效应强度**: [强/中/弱]
- **上涨下跌比例**: [比例]
- **涨跌比评估**: [评估分析]

### 极端表现分析
- **涨停效应**: [涨停股数量分析]
- **跌停风险**: [跌停股数量分析]
- **ST股票表现**: [ST涨停跌停分析]

## 三、市场情绪评估
- **市场整体情绪**: [乐观/中性/悲观]
- **风险偏好水平**: [高/中/低]
- **投资者参与度**: [活跃/一般/低迷]
- **观望情绪强度**: [强/中/弱]

## 四、操作策略建议
### 适合策略
- **推荐策略**: [激进/中性/防御]
- **仓位建议**: [高仓位/中等仓位/低仓位]
- **操作风格**: [追涨杀跌/低吸高抛/观望等待]

### 风险提示
- **主要风险**: [具体风险描述]
- **规避建议**: [需要规避的板块或操作]
- **止损策略**: [止损设置建议]

## 五、市场预判
- **短期走势**: [1-2天预期]
- **中期展望**: [1周预期]
- **关键观察点**: [需要关注的指标或现象]
```

## 约束条件
- 分析必须严格基于提供的市场活跃度数据
- 赚钱效应评估要客观，避免主观臆断
- 投资建议要考虑当前市场环境，谨慎合理
- 所有时间引用必须准确，确保使用{get_current_date()}作为分析基准

---
**数据输入：**

[此处粘贴market_activity_legu.csv的市场活跃度数据内容]"""


# 市场数据分析提示词映射字典
MARKET_PROMPTS = {
    "fund_flow_concept": {
        "market_system_prompt": "thematic_concept_analyst",
        "market_user_prompt": FUND_FLOW_CONCEPT,
    },
    "fund_flow_industry": {
        "market_system_prompt": "sector_rotation_strategist",
        "market_user_prompt": FUND_FLOW_INDUSTRY,
    },
    "sector_fund_flow": {
        "market_system_prompt": "capital_flow_tracker",
        "market_user_prompt": SECTOR_FUND_FLOW,
    },
    "zt_pool": {
        "market_system_prompt": "market_sentiment_vanguard",
        "market_user_prompt": ZT_POOL
    },
    "fund_flow_individual": {
        "market_system_prompt": "individual_flow_analyst",
        "market_user_prompt": FUND_FLOW_INDIVIDUAL
    },
    "lhb_detail": {
        "market_system_prompt": "lhb_decryptor",
        "market_user_prompt": LHB_DETAIL
    },
    "news_main_cx": {
        "market_system_prompt": "financial_news_analyst",
        "market_user_prompt": NEWS_MAIN_CX,
    },
    "market_activity_legu": {
        "market_system_prompt": "market_profitability_analyst",
        "market_user_prompt": MARKET_ACTIVITY_LEGU,
    },
    "market_all_analysis": {
        "market_system_prompt": "chief_investment_strategist",
        "market_user_prompt": MARKET_ALL_ANALYSIS,
    },
    "market_comprehensive_analysis": {
        "market_system_prompt": "chief_investment_strategist",
        "market_user_prompt": MARKET_ALL_ANALYSIS,
    },
}
